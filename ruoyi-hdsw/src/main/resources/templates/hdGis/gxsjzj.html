<!DOCTYPE html>
<html xmlns:th="http://www.w3.org/1999/xhtml" lang="zh">
<head>
    <meta charset="utf-8">
    <title>地图</title>
    <meta name="renderer" content="webkit">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <script th:src="@{/openlayersv6.5/build/ol.js}"></script>
    <script th:src="@{/js/jquery.min.js}"></script>
    <script th:src="@{/js/bd09.js}"></script>
    <script th:src="@{/js/baiduMercator.js}"></script>
    <script th:src="@{/js/olMapConfig.js}"></script>
    <script th:src="@{/js/map.js}"></script>
    <script th:src="@{/js/coordinateTransform.js}"></script>
    <script th:src="@{/zTree/jquery.ztree.core.js}"></script>
    <script th:src="@{/zTree/jquery.ztree.excheck.js}"></script>
    <script th:src="@{/zTree/jquery.ztree.exhide.js}"></script>
    <script th:src="@{/layuiv2.5.6/layui/layui.js}"></script>
    <link th:href="@{/css/bootstrap.min.css}" rel="stylesheet"/>
    <link href="//unpkg.com/layui@2.6.13/dist/css/layui.css" rel="stylesheet"/>
    <link th:href="@{/zTree/zTreeStyle.css}" rel="stylesheet"/>
    <link th:href="@{static/layuiv2.5.6/layui/css/layui.css}" rel="stylesheet"/>
    <link th:href="@{/openlayersv6.5/css/ol.css}" rel="stylesheet"/>
    <link th:href="@{/css/map.css}" rel="stylesheet"/>
    <style>
        .ztree li a span.button {
            background-size: 16px 16px !important;
        }

        .layui-ihh {
            background: rgba(7, 21, 30, 0.9);
            /*box-shadow: 2px 2px 9px 1px #03FFEA;*/
            border-radius: 5px;
            border: 1px solid #03FFEA;
        }

        .cd {
            font-size: 14px !important;
            font-family: MicrosoftYaHei;
            color: #03FFEA !important;
        }

        .content-tab{
            position: absolute;
            z-index: 9999;
            left: 1%;
            top: 1%;
        }
        .tabNav{
            width: 600px;
            list-style: none;
            display: flex;
            justify-content:space-between;
            padding-inline-start: 0px!important;
        }
        .tabNav li{
            width: 110px;
            text-align: center;
            height: 40px;
            line-height: 36px;
            border: 2px solid #ccc;
            border-radius: 10px;
            background: #fff;
            cursor: pointer;
        }
        .active_nav{
            background: #4A98F7!important;
            color: #fff;
        }
        .sty{
            width: 950px;
            max-height: 700px;
            min-height: 150px;
            border-radius: 10px;
            border: 2px solid #ccc;
            padding: 10px;
            background: #fff;
            margin: 10px 0 0 0;
            overflow: auto;
        }
        .sear_sty{
            width: 100%;
            display: flex;
            justify-content: center;
        }
        .sear_sty input{
            margin: 0 10px 0 10px;
        }
        .sear_sty select{
            margin: 0 10px 0 10px;
        }
        .sear_sty button{
            margin: 0 10px 0 10px;
        }
        .form-control{
            width: 150px!important;
            display: inline-block;
        }
        select{
            width: 150px!important;
        }
        .form-group{
            width: 100%;
            /*justify-content:space-around;*/
            margin: 10px 0 10px 0;
        }
        .form-btn{
            display: flex;
            justify-content: space-around;
        }
        h4{
            margin-block-start: 0!important;
            margin-block-end: 0!important;
            margin: 10px 0 0 0!important;
        }
        .layui-form-label{
            width: 130px;
            display: inline-block;
            text-align: right;
        }
        .layui-form select {
             display: block!important;
        }
        .icon-bar {
            right: 50px!important;
        }
        .layerTreeDiv {
            right: 3%!important;
        }
        .btn-mini{
            line-height: 25px;
            padding: 0!important;
        }
        .hzzb{
            display: none;
        }
        .layui-input-inline{
            display: inline-block;
        }
    </style>
</head>
<body>
<div id="mapDiv" class="">
    <div class="baseInfo" id="mapBaseInfo"></div>
    <div class="icon-bar">
        <div class="layui-icon layui-icon-template-1 layui-icon-map"></div>
    </div>
    <div id="featureInfo" class="featureInfo layui-ihh" style="overflow:auto;border-radius:10px;"></div>

    <div class="content-tab">
      <ul class="tabNav">
          <li class="active_nav">参照加点</li>
          <li>解析加点</li>
          <li>解析加线</li>
          <li>插入点</li>
          <li>连接点</li>
      </ul>
       <div class="nav_content">
           <div class="sty" id="czjd">
               <p class="sear_sty"><input type="text" id="search_content1" placeholder="输入名称搜索参照物" autocomplete="off" class="form-control">
                 <button class="btn btn-primary" id="search_btn1">查询</button>
               </p>
               <form class="layui-form" action="">
                   <div class="Mapczw">
                       <div class="form-group">
                   <h4>参照物1:<button type="button" class="btn btn-primary" style="height: 25px;padding: 0!important" id="1" onclick="getCoordinateFlag(this.id)">获取坐标</button>
                       <button type="button" class="btn btn-success" style="height: 25px;padding: 0 5px 0 5px" onclick="computeCoordinate()" >计算</button></h4>
                   <div class="form-group">
                       <div class="layui-input-inline">
                           <label class="layui-form-label">横坐标</label>
                           <input type="text" name="title" id="x1" required  lay-verify="required" placeholder="" autocomplete="off" class="form-control">
                       </div>
                       <div class="layui-input-inline">
                           <label class="layui-form-label">纵坐标</label>
                           <input type="text" name="title" id="y1" required  lay-verify="required" placeholder="" autocomplete="off" class="form-control">
                       </div>
                       <div class="layui-input-inline">
                           <label class="layui-form-label">距离</label>

                           <input type="text" name="title" id="dis1"  required  lay-verify="required" placeholder="" autocomplete="off" class="form-control jl">

                       </div>
                     </div>
                   </div>
                   <div class="form-group">
                       <div class="layui-input-inline">
                           <label class="layui-form-label">角度</label>
                           <input type="text" name="title" id="brng1"  required  lay-verify="required" placeholder="" autocomplete="off" class="form-control">
                       </div>
                   </div>
                   </div>

                   <div class="form-btn">
                       <button type="button" id="add_czw" class="btn btn-primary" style="height: 20px;width:30px;padding: 0!important">+</button>
                       <button type="button" id="reduce_czw" class="btn btn-primary" style="height: 20px;width:30px;padding: 0!important">-</button>
                   </div>
                   <h4>管点属性:</h4>
                   <div class="form-group">
                       <div class="layui-input-inline">
                           <label class="layui-form-label">业务类别</label>
                           <select name="czjd_type1" id="czjd_type1" class="form-control" lay-verify="required">
                               <option value="0">供水</option>
                               <option value="1">污水</option>
                               <option value="2">雨水</option>
                               <option value="3">再生水</option>>
                           </select>
                       </div>
                       <div class="layui-input-inline">
                           <label class="layui-form-label">管点编号</label>
                           <input type="text" name="title" readonly="readonly" id="gdbh1" required  lay-verify="required" placeholder="" autocomplete="off" class="form-control">
                       </div>
                       <div class="layui-input-inline">
                           <label class="layui-form-label">地面高程</label>
                           <input type="text" id="dmgc1" name="title" required  lay-verify="required" placeholder="" autocomplete="off" class="form-control">
                       </div>
                   </div>
                   <div class="form-group">
                       <div class="layui-input-inline">
                           <label class="layui-form-label">特征</label>
                           <input type="text" id="tz1" name="title" required  lay-verify="required" placeholder="" autocomplete="off" class="form-control">
                       </div>
                       <div class="layui-input-inline">
                           <label class="layui-form-label">附属物</label>
                           <input type="text" id="fsw1" name="title" required  lay-verify="required" placeholder="" autocomplete="off" class="form-control">
                       </div>
                       <div class="layui-input-inline">
                           <label class="layui-form-label">井底埋深</label>
                           <input type="text" name="title" id="jdms1" required  lay-verify="required" placeholder="" autocomplete="off" class="form-control">
                       </div>

                   </div>
                   <div class="form-group">
                       <div class="layui-input-inline">
                           <label class="layui-form-label">井盖类型</label>
                           <input type="text" name="title" id="jglx1" required  lay-verify="required" placeholder="" autocomplete="off" class="form-control">
                       </div>
                       <div class="layui-input-inline">
                           <label class="layui-form-label">井盖规格</label>
                           <input type="text" name="title" id="jggg1" required  lay-verify="required" placeholder="" autocomplete="off" class="form-control">
                       </div>
                       <div class="layui-input-inline">
                           <label class="layui-form-label">井盖材质</label>
                           <input type="text" name="title" id="jgcz1" required  lay-verify="required" placeholder="" autocomplete="off" class="form-control">
                       </div>

                   </div>
                   <div class="form-group">
                       <div class="layui-input-inline">
                           <label class="layui-form-label">井室材质</label>
                           <input type="text" name="title" id="jscz1" required  lay-verify="required" placeholder="" autocomplete="off" class="form-control">
                       </div>
                       <div class="layui-input-inline">
                           <label class="layui-form-label">井室类型</label>
                           <input type="text" name="title" id="jslx1" required  lay-verify="required" placeholder="" autocomplete="off" class="form-control">
                       </div>
                       <div class="layui-input-inline">
                           <label class="layui-form-label">井脖深</label>
                           <input type="text" name="title" id="jbs1" required  lay-verify="required" placeholder="" autocomplete="off" class="form-control">
                       </div>
                   </div>
                   <div class="form-group">
                       <div class="layui-input-inline">
                           <label class="layui-form-label">井室直径</label>
                           <input type="text" name="title" id="jszj1" required  lay-verify="required" placeholder="" autocomplete="off" class="form-control">
                           <em>米</em>
                       </div>
                       <div class="layui-input-inline">
                           <label class="layui-form-label">权属单位</label>
                           <input type="text" name="title" id="qsdw1" required  lay-verify="required" placeholder="" autocomplete="off" class="form-control">
                       </div>
                       <div class="layui-input-inline">
                           <label class="layui-form-label">建设日期</label>
                           <input type="text" class="layui-input form-control" id="jsrq1">
<!--                           <input type="text" name="title" required  lay-verify="required" placeholder="" autocomplete="off" class="form-control">-->
                       </div>
                   </div>
                   <div class="form-group">
                       <div class="layui-input-inline">
                           <label class="layui-form-label">偏心井点号</label>
                           <input type="text" name="title" id="pxjdh1" required  lay-verify="required" placeholder="" autocomplete="off" class="form-control">
                       </div>
                       <div class="layui-input-inline">
                           <label class="layui-form-label">旋转角度</label>
                           <input type="text" name="title" id="xzjd1" required  lay-verify="required" placeholder="" autocomplete="off" class="form-control">
                       </div>
                       <div class="layui-input-inline">
                           <label class="layui-form-label">所在道路</label>
                           <input type="text" name="title" id="szdl1" required  lay-verify="required" placeholder="" autocomplete="off" class="form-control">
                       </div>

                   </div>
                   <div class="form-group">
                       <div class="layui-input-inline">
                           <label class="layui-form-label">标高</label>
                           <input type="text" name="title" id="bg1" required  lay-verify="required" placeholder="" autocomplete="off" class="form-control">
                       </div>
                       <div class="layui-input-inline">
                           <label class="layui-form-label">X坐标</label>
                           <input type="text" name="title" id="xcor1" required  lay-verify="required" placeholder="" autocomplete="off" class="form-control">
                       </div>
                       <div class="layui-input-inline">
                           <label class="layui-form-label">Y坐标</label>
                           <input type="text" name="title" id="ycor1" required  lay-verify="required" placeholder="" autocomplete="off" class="form-control">
                       </div>
                   </div>
                   <div class="form-group form-btn">
                       <button type="button" class="btn btn-primary" onclick="save1()">确定</button>
                       <button type="button" class="btn btn-primary">取消</button>
                   </div>
               </form>
           </div>

           <div class="sty" style="display: none" id="jxjd">
               <div class="form-check form-check-inline">
                   <input class="form-check-input" type="radio" name="exampleRadios" id="exampleRadios1" value="1" checked>
                   <label class="form-check-label" for="exampleRadios1">
                       解析法
                   </label>
                   <input class="form-check-input" type="radio" name="exampleRadios" id="exampleRadios2" value="2" >
                   <label class="form-check-label" for="exampleRadios2">
                       页面输入法
                   </label>
               </div>


               <div id="jxf">
                   <div class="form-group">
                       <button type="button" class="btn btn-primary btn-sm">下载模板</button>
                   </div>
                   <div class="form-group">
                       <input class="btn btn-primary" type="file">
                   </div>
                   <div class="form-group">
                   <div class="">
                       <label class="layui-form-label">数据文件</label>
                       <input type="text" name="title" required  style="width: 200px" lay-verify="required" placeholder="" autocomplete="off" class="form-control">
                   </div>
                   </div>
                   <div class="form-group" style="text-align: center">
                       <button class="btn btn-primary" type="submit" value="Submit">确定</button>
                       <button class="btn btn-primary" type="reset" value="Reset">取消</button>
                   </div>
               </div>

               <div id="ymsrf" style="display: none">
                   <form class="layui-form" action="">
                       <h4>管点坐标:</h4>
                       <div class="form-group">
                           <div class="layui-input-inline">
                               <label class="layui-form-label">横坐标</label>
                               <input type="text" name="title" id="xcor2" required  lay-verify="required" placeholder="" autocomplete="off" class="form-control">
                           </div>
                           <div class="layui-input-inline">
                               <label class="layui-form-label">纵坐标</label>
                               <input type="text" name="title" id="ycor2" required  lay-verify="required" placeholder="" autocomplete="off" class="form-control">
                           </div>
                       </div>
                       <h4>管点属性:</h4>
                       <div class="form-group">
                           <div class="layui-input-inline">
                               <label class="layui-form-label">业务类别</label>
                               <select name="czjd_type2" id="czjd_type2" class="form-control" lay-verify="required">
                                   <option value="0">供水</option>
                                   <option value="1">污水</option>
                                   <option value="2">雨水</option>
                                   <option value="3">再生水</option>>
                               </select>
                           </div>
                           <div class="layui-input-inline">
                               <label class="layui-form-label">管点编号</label>
                               <input type="text" name="title" readonly="readonly"  id="gdbh2" required  lay-verify="required" placeholder="" autocomplete="off" class="form-control">
                           </div>
                           <div class="layui-input-inline">
                               <label class="layui-form-label">地面高程</label>
                               <input type="text" id="dmgc2" name="title" required  lay-verify="required" placeholder="" autocomplete="off" class="form-control">
                           </div>
                       </div>
                       <div class="form-group">
                           <div class="layui-input-inline">
                               <label class="layui-form-label">特征</label>
                               <input type="text" id="tz2" name="title" required  lay-verify="required" placeholder="" autocomplete="off" class="form-control">
                           </div>
                           <div class="layui-input-inline">
                               <label class="layui-form-label">附属物</label>
                               <input type="text" id="fsw2" name="title" required  lay-verify="required" placeholder="" autocomplete="off" class="form-control">
                           </div>
                           <div class="layui-input-inline">
                               <label class="layui-form-label">井底埋深</label>
                               <input type="text" name="title" id="jdms2" required  lay-verify="required" placeholder="" autocomplete="off" class="form-control">
                           </div>

                       </div>
                       <div class="form-group">
                           <div class="layui-input-inline">
                               <label class="layui-form-label">井盖类型</label>
                               <input type="text" name="title" id="jglx2" required  lay-verify="required" placeholder="" autocomplete="off" class="form-control">
                           </div>
                           <div class="layui-input-inline">
                               <label class="layui-form-label">井盖规格</label>
                               <input type="text" name="title" id="jggg2" required  lay-verify="required" placeholder="" autocomplete="off" class="form-control">
                           </div>
                           <div class="layui-input-inline">
                               <label class="layui-form-label">井盖材质</label>
                               <input type="text" name="title" id="jgcz2" required  lay-verify="required" placeholder="" autocomplete="off" class="form-control">
                           </div>

                       </div>
                       <div class="form-group">
                           <div class="layui-input-inline">
                               <label class="layui-form-label">井室材质</label>
                               <input type="text" name="title" id="jscz2" required  lay-verify="required" placeholder="" autocomplete="off" class="form-control">
                           </div>
                           <div class="layui-input-inline">
                               <label class="layui-form-label">井室类型</label>
                               <input type="text" name="title" id="jslx2" required  lay-verify="required" placeholder="" autocomplete="off" class="form-control">
                           </div>
                           <div class="layui-input-inline">
                               <label class="layui-form-label">井脖深</label>
                               <input type="text" name="title" id="jbs2" required  lay-verify="required" placeholder="" autocomplete="off" class="form-control">
                           </div>
                       </div>
                       <div class="form-group">
                           <div class="layui-input-inline">
                               <label class="layui-form-label">井室直径</label>
                               <input type="text" name="title" id="jszj2" required  lay-verify="required" placeholder="" autocomplete="off" class="form-control">
                               <em>米</em>
                           </div>
                           <div class="layui-input-inline">
                               <label class="layui-form-label">权属单位</label>
                               <input type="text" name="title" id="qsdw2" required  lay-verify="required" placeholder="" autocomplete="off" class="form-control">
                           </div>
                           <div class="layui-input-inline">
                               <label class="layui-form-label">建设日期</label>
                               <input type="text" class="layui-input form-control" id="jsrq2">
                               <!--                           <input type="text" name="title" required  lay-verify="required" placeholder="" autocomplete="off" class="form-control">-->
                           </div>
                       </div>
                       <div class="form-group">
                           <div class="layui-input-inline">
                               <label class="layui-form-label">偏心井点号</label>
                               <input type="text" name="title" id="pxjdh2" required  lay-verify="required" placeholder="" autocomplete="off" class="form-control">
                           </div>
                           <div class="layui-input-inline">
                               <label class="layui-form-label">旋转角度</label>
                               <input type="text" name="title" id="xzjd2" required  lay-verify="required" placeholder="" autocomplete="off" class="form-control">
                           </div>
                           <div class="layui-input-inline">
                               <label class="layui-form-label">所在道路</label>
                               <input type="text" name="title" id="szdl2" required  lay-verify="required" placeholder="" autocomplete="off" class="form-control">
                           </div>

                       </div>
                       <div class="form-group">
                           <div class="layui-input-inline">
                               <label class="layui-form-label">标高</label>
                               <input type="text" name="title" id="bg2" required  lay-verify="required" placeholder="" autocomplete="off" class="form-control">
                           </div>
                       </div>
                       <div class="form-group form-btn">
                           <button type="button" class="btn btn-primary" onclick="save2()">确定</button>
                           <button type="button" class="btn btn-primary">取消</button>
                       </div>
                   </form>
               </div>
           </div>

           <div class="sty" id="jxjx" style="display: none">
               <div class="form-check form-check-inline">
                   <input class="form-check-input" type="radio" name="jxjx"  value="1" checked>
                   <label class="form-check-label" for="exampleRadios1">
                       解析法
                   </label>
                   <input class="form-check-input" type="radio" name="jxjx"  value="2" >
                   <label class="form-check-label" for="exampleRadios2">
                       页面输入法
                   </label>
               </div>


               <div id="jxf_">
                   <div class="form-group">
                       <input class="btn btn-primary" type="file">
                   </div>
                   <div class="form-group">
                       <div class="">
                           <label class="layui-form-label">数据文件</label>
                           <input type="text" name="title" required  style="width: 200px" lay-verify="required" placeholder="" autocomplete="off" class="form-control">
                       </div>
                   </div>
                   <div class="form-group" style="text-align: center">
                       <button class="btn btn-primary" type="submit" value="Submit">确定</button>
                       <button class="btn btn-primary" type="reset" value="Reset">取消</button>
                   </div>
               </div>

               <div id="ymsrf_" style="display: none">
                   <form class="layui-form" action="">
                       <h4>起点坐标:</h4>
                       <div class="form-group">
                           <div class="layui-input-inline">
                               <label class="layui-form-label">编号</label>
                               <input type="text" name="title" id="qdbh3" required  lay-verify="required" placeholder="" autocomplete="off" class="form-control">
                               <button class="btn btn-primary btn-mini qdzb" id="xqd" onclick="getCoordinateFlag(this.id)">选点坐标</button>
                           </div>
                       </div>
                       <div class="form-group hzzb" id="qdzb">
                           <div class="layui-input-inline">
                               <label class="layui-form-label">横坐标</label>
                               <input type="text" name="title" id="qdxcor3" required  lay-verify="required" placeholder="" autocomplete="off" class="form-control">
                           </div>
                           <div class="layui-input-inline">
                               <label class="layui-form-label">纵坐标</label>
                               <input type="text" name="title" id="qdycor3" required  lay-verify="required" placeholder="" autocomplete="off" class="form-control">
                           </div>
                       </div>
                       <h4>终点坐标:</h4>
                       <div class="form-group">
                           <div class="layui-input-inline">
                               <label class="layui-form-label">编号</label>
                               <input type="text" name="title" id="zdbh3" required  lay-verify="required" placeholder="" autocomplete="off" class="form-control">
                               <button class="btn btn-primary btn-mini zdzb" id="xzd" onclick="getCoordinateFlag(this.id)">选点坐标</button>
                           </div>
                       </div>
                       <div class="form-group hzzb" id="zdzb">
                           <div class="layui-input-inline">
                               <label class="layui-form-label">横坐标</label>
                               <input type="text" name="title" id="zdxcor3" required  lay-verify="required" placeholder="" autocomplete="off" class="form-control">
                           </div>
                           <div class="layui-input-inline">
                               <label class="layui-form-label">纵坐标</label>
                               <input type="text" name="title" id="zdycor3" required  lay-verify="required" placeholder="" autocomplete="off" class="form-control">
                           </div>
                       </div>
                       <h4>管线属性:</h4>
                       <div class="form-group">
                           <div class="layui-input-inline">
                               <label class="layui-form-label">业务类别</label>
                               <select name="czjd_type3" id="czjd_type3" class="form-control" lay-verify="required">
                                   <option value="0">供水</option>
                                   <option value="1">污水</option>
                                   <option value="2">雨水</option>
                                   <option value="3">再生水</option>>
                               </select>
                           </div>
                           <div class="layui-input-inline">
                               <label class="layui-form-label">管线编号</label>
                               <input type="text" name="title" readonly="readonly" id="gxbh3" required  lay-verify="required" placeholder="" autocomplete="off" class="form-control">
                           </div>
<!--                           <div class="layui-input-inline">
                               <label class="layui-form-label">起点点号</label>
                               <input type="text" name="title" id="" required  lay-verify="required" placeholder="" autocomplete="off" class="form-control">
                           </div>
                           <div class="layui-input-inline">
                               <label class="layui-form-label">终点点号</label>
                               <input type="text" name="title" required  lay-verify="required" placeholder="" autocomplete="off" class="form-control">
                           </div>-->
                           <div class="layui-input-inline">
                               <label class="layui-form-label">起点埋深</label>
                               <input type="text" name="title" id="qdms3" required  lay-verify="required" placeholder="" autocomplete="off" class="form-control">
                           </div>
                       </div>
                       <div class="form-group">

                           <div class="layui-input-inline">
                               <label class="layui-form-label">终点埋深</label>
                               <input type="text" name="title" id="zdms3" required  lay-verify="required" placeholder="" autocomplete="off" class="form-control">
                           </div>
                           <div class="layui-input-inline">
                               <label class="layui-form-label">起点高程</label>
                               <input type="text" name="title" id="qdgc3" required  lay-verify="required" placeholder="" autocomplete="off" class="form-control">
                           </div>
                           <div class="layui-input-inline">
                               <label class="layui-form-label">终点高程</label>
                               <input type="text" name="title" id="zdgc3" required  lay-verify="required" placeholder="" autocomplete="off" class="form-control">
                           </div>
                       </div>
                       <div class="form-group">
                           <div class="layui-input-inline">
                               <label class="layui-form-label">材质</label>
                               <input type="text" name="title" id="cz3" required  lay-verify="required" placeholder="" autocomplete="off" class="form-control">
                           </div>
                           <div class="layui-input-inline">
                               <label class="layui-form-label">埋设方式</label>
                               <input type="text" name="title" id="msfs3" required  lay-verify="required" placeholder="" autocomplete="off" class="form-control">
                           </div>
                           <div class="layui-input-inline">
                               <label class="layui-form-label">线型</label>
                               <input type="text" name="title" id="xx3" required  lay-verify="required" placeholder="" autocomplete="off" class="form-control">
                           </div>
                       </div>
                       <div class="form-group">
                           <div class="layui-input-inline">
                               <label class="layui-form-label">管径</label>
                               <input type="text" name="title" id="gj3" required  lay-verify="required" placeholder="" autocomplete="off" class="form-control"><em>毫米</em>
                           </div>
                           <div class="layui-input-inline">
                               <label class="layui-form-label">建设日期</label>
                               <input type="text" name="title" id="jsrq3" class="form-control">
                           </div>
                           <div class="layui-input-inline">
                               <label class="layui-form-label">权属单位编号</label>
                               <input type="text" name="title" id="qsdwbh3" required  lay-verify="required" placeholder="" autocomplete="off" class="form-control">
                           </div>
                       </div>
                       <div class="form-group">
                           <div class="layui-input-inline">
                               <label class="layui-form-label">流向</label>
                               <input type="text" name="title" id="lx3" required  lay-verify="required" placeholder="" autocomplete="off" class="form-control">
                           </div>
                           <div class="layui-input-inline">
                               <label class="layui-form-label">所在道路</label>
                               <input type="text" name="title" id="szdl3" required  lay-verify="required" placeholder="" autocomplete="off" class="form-control">
                           </div>
                           <div class="layui-input-inline">
                               <label class="layui-form-label">状态</label>
                               <input type="text" name="title" id="zt3" required  lay-verify="required" placeholder="" autocomplete="off" class="form-control">
                           </div>
                       </div>
                       <div class="form-group">
                           <div class="layui-input-inline">
                               <label class="layui-form-label">类别</label>
                               <input type="text" name="title" id="lb3" required  lay-verify="required" placeholder="" autocomplete="off" class="form-control">
                           </div>
                           <div class="layui-input-inline">
                               <label class="layui-form-label">长度</label>
                               <input type="text" name="title" id="cd3" required  lay-verify="required" placeholder="" autocomplete="off" class="form-control">
                           </div>
                       </div>
                       <div class="form-group" style="text-align: center">
                           <button type="button" class="btn btn-primary" onclick="save3()">确定</button>
                           <button type="button" class="btn btn-primary">取消</button>
                       </div>
                   </form>
               </div>
           </div>

           <div class="sty" id="crd" style="display: none">
               <p class="sear_sty">
<!--                   <select name="city" class="form-control" lay-verify="required">
                       <option value=""></option>
                       <option value="0">北京</option>
                       <option value="1">上海</option>
                       <option value="2">广州</option>
                       <option value="3">深圳</option>
                       <option value="4">杭州</option>
                   </select>-->

                   <input type="text"  id="search_content4" placeholder="输入名称搜索参照物" autocomplete="off" class="form-control">
                   <button class="btn btn-primary" id="search_btn4">查询</button>
               </p>
               <form class="layui-form" action="">
                   <h4>管线信息:<button type="button" class="btn btn-primary" style="height: 20px;padding: 0!important" onclick="drawLine()">请点击地图中的管线获取信息</button></h4>
                   <div class="form-group">
                       <div class="layui-input-inline">
                           <label class="layui-form-label">管线编号</label>
                           <input type="text" name="title" id="gxbh4" required  lay-verify="required" placeholder="" autocomplete="off" class="form-control">
                       </div>
                       <div class="layui-input-inline">
                           <label class="layui-form-label">起点编号</label>
                           <input type="text" name="title" id="qdbh4" required  lay-verify="required" placeholder="" autocomplete="off" class="form-control">
                       </div>
                       <div class="layui-input-inline">
                           <label class="layui-form-label">终点编号</label>
                           <input type="text" name="title" id="zdbh4" required  lay-verify="required" placeholder="" autocomplete="off" class="form-control">
                       </div>
                   </div>
                   <h4>新增管点信息:</h4>
                   <div class="form-group">
                       <div class="layui-input-inline">
                           <label class="layui-form-label">业务类别</label>
                           <input type="text" name="title" id="ywlb4" required  lay-verify="required" placeholder="" autocomplete="off" class="form-control">
                       </div>
                       <div class="layui-input-inline">
                           <label class="layui-form-label">管点编号</label>
                           <input type="text" name="title" id="gdbh4" required  lay-verify="required" placeholder="" autocomplete="off" class="form-control">
                       </div>
                       <div class="layui-input-inline">
                           <label class="layui-form-label">地面高程</label>
                           <input type="text" id="dmgc4" name="title" required  lay-verify="required" placeholder="" autocomplete="off" class="form-control">
                       </div>
                   </div>
                   <div class="form-group">
                       <div class="layui-input-inline">
                           <label class="layui-form-label">特征</label>
                           <input type="text" id="tz4" name="title" required  lay-verify="required" placeholder="" autocomplete="off" class="form-control">
                       </div>
                       <div class="layui-input-inline">
                           <label class="layui-form-label">附属物</label>
                           <input type="text" id="fsw4" name="title" required  lay-verify="required" placeholder="" autocomplete="off" class="form-control">
                       </div>
                       <div class="layui-input-inline">
                           <label class="layui-form-label">井底埋深</label>
                           <input type="text" name="title" id="jdms4" required  lay-verify="required" placeholder="" autocomplete="off" class="form-control">
                       </div>

                   </div>
                   <div class="form-group">
                       <div class="layui-input-inline">
                           <label class="layui-form-label">井盖类型</label>
                           <input type="text" name="title" id="jglx4" required  lay-verify="required" placeholder="" autocomplete="off" class="form-control">
                       </div>
                       <div class="layui-input-inline">
                           <label class="layui-form-label">井盖规格</label>
                           <input type="text" name="title" id="jggg4" required  lay-verify="required" placeholder="" autocomplete="off" class="form-control">
                       </div>
                       <div class="layui-input-inline">
                           <label class="layui-form-label">井盖材质</label>
                           <input type="text" name="title" id="jgcz4" required  lay-verify="required" placeholder="" autocomplete="off" class="form-control">
                       </div>

                   </div>
                   <div class="form-group">
                       <div class="layui-input-inline">
                           <label class="layui-form-label">井室材质</label>
                           <input type="text" name="title" id="jscz4" required  lay-verify="required" placeholder="" autocomplete="off" class="form-control">
                       </div>
                       <div class="layui-input-inline">
                           <label class="layui-form-label">井室类型</label>
                           <input type="text" name="title" id="jslx4" required  lay-verify="required" placeholder="" autocomplete="off" class="form-control">
                       </div>
                       <div class="layui-input-inline">
                           <label class="layui-form-label">井脖深</label>
                           <input type="text" name="title" id="jbs4" required  lay-verify="required" placeholder="" autocomplete="off" class="form-control">
                       </div>
                   </div>
                   <div class="form-group">
                       <div class="layui-input-inline">
                           <label class="layui-form-label">井室直径</label>
                           <input type="text" name="title" id="jszj4" required  lay-verify="required" placeholder="" autocomplete="off" class="form-control">
                           <em>米</em>
                       </div>
                       <div class="layui-input-inline">
                           <label class="layui-form-label">权属单位</label>
                           <input type="text" name="title" id="qsdw4" required  lay-verify="required" placeholder="" autocomplete="off" class="form-control">
                       </div>
                       <div class="layui-input-inline">
                           <label class="layui-form-label">建设日期</label>
                           <input type="text" class="layui-input form-control" id="jsrq4">
                           <!--                           <input type="text" name="title" required  lay-verify="required" placeholder="" autocomplete="off" class="form-control">-->
                       </div>
                   </div>
                   <div class="form-group">
                       <div class="layui-input-inline">
                           <label class="layui-form-label">偏心井点号</label>
                           <input type="text" name="title" id="pxjdh4" required  lay-verify="required" placeholder="" autocomplete="off" class="form-control">
                       </div>
                       <div class="layui-input-inline">
                           <label class="layui-form-label">旋转角度</label>
                           <input type="text" name="title" id="xzjd4" required  lay-verify="required" placeholder="" autocomplete="off" class="form-control">
                       </div>
                       <div class="layui-input-inline">
                           <label class="layui-form-label">所在道路</label>
                           <input type="text" name="title" id="szdl4" required  lay-verify="required" placeholder="" autocomplete="off" class="form-control">
                       </div>

                   </div>
                   <div class="form-group">
                       <div class="layui-input-inline">
                           <label class="layui-form-label">标高</label>
                           <input type="text" name="title" id="bg4" required  lay-verify="required" placeholder="" autocomplete="off" class="form-control">
                       </div>
                       <div class="layui-input-inline">
                           <label class="layui-form-label">X坐标</label>
                           <input type="text" name="title" id="xcor4" required  lay-verify="required" placeholder="" autocomplete="off" class="form-control">
                       </div>
                       <div class="layui-input-inline">
                           <label class="layui-form-label">Y坐标</label>
                           <input type="text" name="title" id="ycor4" required  lay-verify="required" placeholder="" autocomplete="off" class="form-control">
                       </div>
                   </div>
                   <div class="form-group form-btn" style="text-align: center">
                       <button type="button" class="btn btn-primary" onclick="save4()">确定</button>
                       <button type="button" class="btn btn-primary">取消</button>
                   </div>
               </form>
           </div>

           <div class="sty" id="ljd" style="display: none">
               <p class="sear_sty">
                   <label class="layui-form-label">业务类别</label>
                   <select name="czjd_type5" id="czjd_type5" class="form-control" lay-verify="required">
                       <option value="0">供水</option>
                       <option value="1">污水</option>
                       <option value="2">雨水</option>
                       <option value="3">再生水</option>>
                   </select>
                   <button class="btn btn-primary">查询</button>
               </p>
               <form class="layui-form" action="">
                   <h4>起点信息:<button type="button" class="btn btn-primary" id="xqd5" onclick="getCoordinateFlag(this.id)" style="height: 20px;padding: 0!important">请点击地图中的管点获取信息</button></h4>
                   <div class="form-group">
                       <div class="layui-input-inline">
                           <label class="layui-form-label">管点编号</label>
                           <input type="text" name="title" id="qdgdbh5" required  lay-verify="required" placeholder="" autocomplete="off" class="form-control">
                       </div>
                       <div class="layui-input-inline">
                           <label class="layui-form-label">类型</label>
                           <input type="text" name="title" id="qdgdlx5"  required  lay-verify="required" placeholder="" autocomplete="off" class="form-control">
                       </div>
                       <div class="layui-input-inline">
                           <label class="layui-form-label">权属单位</label>
                           <input type="text" name="title" id="qdgdqsdw5"  required  lay-verify="required" placeholder="" autocomplete="off" class="form-control">
                       </div>
<!--                       <div class="layui-input-inline">
                           <label class="layui-form-label">行政区属</label>
                           <input type="text" name="title" id="qdgdxzqs5"  required  lay-verify="required" placeholder="" autocomplete="off" class="form-control">
                       </div>-->
                   </div>
                   <div class="form-group hzzb" id="qdzb5" hidden="hidden">
                       <div class="layui-input-inline">
                           <label class="layui-form-label">横坐标</label>
                           <input type="text" name="title" id="qdxcor5" required  lay-verify="required" placeholder="" autocomplete="off" class="form-control">
                       </div>
                       <div class="layui-input-inline">
                           <label class="layui-form-label">纵坐标</label>
                           <input type="text" name="title" id="qdycor5" required  lay-verify="required" placeholder="" autocomplete="off" class="form-control">
                       </div>
                   </div>
<!--                   <div class="form-group">
                       <div class="layui-input-inline">
                           <label class="layui-form-label">权属单位</label>
                           <input type="text" name="title" id="qdgdqsdw5"  required  lay-verify="required" placeholder="" autocomplete="off" class="form-control">
                       </div>
                   </div>-->
                   <h4>终点信息:<button type="button" class="btn btn-primary" id="xzd5" onclick="getCoordinateFlag(this.id)"  style="height: 20px;padding: 0!important">请点击地图中的管点获取信息</button></h4>
                   <div class="form-group">
                       <div class="layui-input-inline">
                           <label class="layui-form-label">管点编号</label>
                           <input type="text" name="title" id="zdgdbh5" required  lay-verify="required" placeholder="" autocomplete="off" class="form-control">
                       </div>
                       <div class="layui-input-inline">
                           <label class="layui-form-label">类型</label>
                           <input type="text" name="title" id="zdgdlx5"  required  lay-verify="required" placeholder="" autocomplete="off" class="form-control">
                       </div>
                       <div class="layui-input-inline">
                           <label class="layui-form-label">权属单位</label>
                           <input type="text" name="title" id="zdgdqsdw5"  required  lay-verify="required" placeholder="" autocomplete="off" class="form-control">
                       </div>
<!--                       <div class="layui-input-inline">
                           <label class="layui-form-label">行政区属</label>
                           <input type="text" name="title" id="zdgdxzqs5"  required  lay-verify="required" placeholder="" autocomplete="off" class="form-control">
                       </div>-->
                   </div>
                   <div class="form-group hzzb" id="zdzb5" hidden="hidden">
                       <div class="layui-input-inline">
                           <label class="layui-form-label">横坐标</label>
                           <input type="text" name="title" id="zdxcor5" required  lay-verify="required" placeholder="" autocomplete="off" class="form-control">
                       </div>
                       <div class="layui-input-inline">
                           <label class="layui-form-label">纵坐标</label>
                           <input type="text" name="title" id="zdycor5" required  lay-verify="required" placeholder="" autocomplete="off" class="form-control">
                       </div>
                   </div>
<!--                   <div class="form-group">
                       <div class="layui-input-inline">
                           <label class="layui-form-label">权属单位</label>
                           <input type="text" name="title" id="zdgdqsdw5"  required  lay-verify="required" placeholder="" autocomplete="off" class="form-control">
                       </div>
                   </div>-->
                   <h4>管线属性:</h4>
                   <div class="form-group">
                       <div class="layui-input-inline">
                           <label class="layui-form-label">管线编号</label>
                           <input type="text" name="title" readonly="readonly"  id="gxbh5" required  lay-verify="required" placeholder="" autocomplete="off" class="form-control">
                       </div>
                       <div class="layui-input-inline">
                           <label class="layui-form-label">起点点号</label>
                           <input type="text" name="title" id="qdbh5" required  lay-verify="required" placeholder="" autocomplete="off" class="form-control">
                       </div>
                       <div class="layui-input-inline">
                           <label class="layui-form-label">终点点号</label>
                           <input type="text" name="title" id="zdbh5" required  lay-verify="required" placeholder="" autocomplete="off" class="form-control">
                       </div>
                   </div>
                   <div class="form-group">
                       <div class="layui-input-inline">
                           <label class="layui-form-label">起点埋深</label>
                           <input type="text" name="title" id="qdms5" required  lay-verify="required" placeholder="" autocomplete="off" class="form-control">
                       </div>
                       <div class="layui-input-inline">
                           <label class="layui-form-label">终点埋深</label>
                           <input type="text" name="title" id="zdms5" required  lay-verify="required" placeholder="" autocomplete="off" class="form-control">
                       </div>
                       <div class="layui-input-inline">
                           <label class="layui-form-label">起点高程</label>
                           <input type="text" name="title" id="qdgc5" required  lay-verify="required" placeholder="" autocomplete="off" class="form-control">
                       </div>
                   </div>
                   <div class="form-group">
                       <div class="layui-input-inline">
                           <label class="layui-form-label">终点高程</label>
                           <input type="text" name="title" id="zdgc5" required  lay-verify="required" placeholder="" autocomplete="off" class="form-control">
                       </div>
                       <div class="layui-input-inline">
                           <label class="layui-form-label">材质</label>
                           <input type="text" name="title" id="cz5" required  lay-verify="required" placeholder="" autocomplete="off" class="form-control">
                       </div>
                       <div class="layui-input-inline">
                           <label class="layui-form-label">埋设方式</label>
                           <input type="text" name="title" id="msfs5" required  lay-verify="required" placeholder="" autocomplete="off" class="form-control">
                       </div>
                   </div>
                   <div class="form-group">
                       <div class="layui-input-inline">
                           <label class="layui-form-label">线型</label>
                           <input type="text" name="title" id="xx5" required  lay-verify="required" placeholder="" autocomplete="off" class="form-control">
                       </div>
                       <div class="layui-input-inline">
                           <label class="layui-form-label">管径</label>
                           <input type="text" name="title" id="gj5" required  lay-verify="required" placeholder="" autocomplete="off" class="form-control"><em>毫米</em>
                       </div>
                       <div class="layui-input-inline">
                           <label class="layui-form-label">建设日期</label>
                           <input type="text" name="title" id="jsrq5" class="form-control">
                       </div>
                   </div>
                   <div class="form-group">
                       <div class="layui-input-inline">
                           <label class="layui-form-label">权属单位编号</label>
                           <input type="text" name="title" id="qsdwbh5" required  lay-verify="required" placeholder="" autocomplete="off" class="form-control">
                       </div>
                       <div class="layui-input-inline">
                           <label class="layui-form-label">流向</label>
                           <input type="text" name="title" id="lx5" required  lay-verify="required" placeholder="" autocomplete="off" class="form-control">
                       </div>
                       <div class="layui-input-inline">
                           <label class="layui-form-label">所在道路</label>
                           <input type="text" name="title" id="szdl5" required  lay-verify="required" placeholder="" autocomplete="off" class="form-control">
                       </div>
                   </div>
                   <div class="form-group">
                       <div class="layui-input-inline">
                           <label class="layui-form-label">状态</label>
                           <input type="text" name="title" id="zt5" required  lay-verify="required" placeholder="" autocomplete="off" class="form-control">
                       </div>
                       <div class="layui-input-inline">
                           <label class="layui-form-label">类别</label>
                           <input type="text" name="title" id="lb5" required  lay-verify="required" placeholder="" autocomplete="off" class="form-control">
                       </div>
                       <div class="layui-input-inline">
                           <label class="layui-form-label">长度</label>
                           <input type="text" name="title" id="cd5" required  lay-verify="required" placeholder="" autocomplete="off" class="form-control">
                       </div>
                   </div>
                   <div class="form-group form-btn">
                       <button type="button" class="btn btn-primary" onclick="save5()">确定</button>
                       <button type="button" class="btn btn-primary">取消</button>
                   </div>
               </form>
           </div>
       </div>
    </div>

    <div class="layerTreeDiv">
        <div class="layerControlTitle">图层控制</div>
        <!--<div><span>图层控制</span></div>-->
        <ul id="treeDemo" class=" ztree"></ul>
    </div>
</div>

</body>
</html>
<script>

    //图层收缩事件
    $('.icon-bar').click(function(){
        $('.layerTreeDiv').toggle();
    })
    //解析加线点击事件
    $('.qdzb').click(function (){
        $('#qdzb').toggle();
    })
    $('.zdzb').click(function (){
        $('#zdzb').toggle();
    })

    $('.tabNav li').click(function(){
        $(this).addClass('active_nav').siblings().removeClass('active_nav');
        if($(this).index() == 0){
            $('#czjd').toggle();
            $('#czjd').siblings().hide();
            setBh("gspoint","GSP","gdbh1")
        }else if($(this).index() == 1){
            $('#jxjd').toggle();
            $('#jxjd').siblings().hide();
            setBh("gspoint","GSP","gdbh2")
        }else if($(this).index() == 2){
            $('#jxjx').toggle();
            $('#jxjx').siblings().hide();
            setBh("gsline","GSL","gxbh3")
        }else if($(this).index() == 3){
            $('#crd').toggle();
            $('#crd').siblings().hide();
        }else if($(this).index() == 4){
            $('#ljd').toggle();
            $('#ljd').siblings().hide();
            setBh("gsline","GSL","gxbh5")
        }
    })

    //解析加点单选事件
    $('input[name="exampleRadios"]').click(function(){
        if($(this).val() == 1){
            $('#jxf').show();
            $('#ymsrf').hide();
        }else{
            $('#ymsrf').show();
            $('#jxf').hide();
        }
    })

    //解析加线单选事件
    $('input[name="jxjx"]').click(function(){
        if($(this).val() == 1){
            $('#jxf_').show();
            $('#ymsrf_').hide();
        }else{
            $('#ymsrf_').show();
            $('#jxf_').hide();
        }
    })

    //参照物循环增加事件
    var num = 1;
    var zh_;
    $('#add_czw').click(function(){
        if(num == 1){
            let zh = num++;
            zh_ = zh + 1;
            let str = `
<div id="`+zh_+`">
          <h4>参照物`+zh_+`:<button type="button" class="btn btn-primary" style="height: 20px;padding: 0!important" id="`+zh_+`" onclick="getCoordinateFlag(`+zh_+`)">获取坐标</button></h4>
                   <div class="form-group">
                       <div class="layui-input-inline">
                           <label class="layui-form-label">横坐标</label>
                           <input type="text" name="title" id="x2" required  lay-verify="required" placeholder="" autocomplete="off" class="form-control">
                       </div>
                       <div class="layui-input-inline">
                           <label class="layui-form-label">纵坐标</label>
                           <input type="text" name="title" id="y2" required  lay-verify="required" placeholder="" autocomplete="off" class="form-control">
                       </div>
                       <div class="layui-input-inline">
                           <label class="layui-form-label">距离</label>
                           <input type="text" name="title"  id="dist2" required  lay-verify="required" placeholder="" autocomplete="off" class="form-control jl">
                       </div>
                   </div>
                   <div class="form-group">
                       <div class="layui-input-inline">
                           <label class="layui-form-label">角度</label>
                           <input type="text" name="title" id="brng2" required  lay-verify="required" placeholder="" autocomplete="off" class="form-control">
                       </div>
                   </div></div>
        `
            $('.Mapczw').append(str)
            $('.jl').attr('disabled',true)
        }

    })

    $('#reduce_czw').click(function (){
        $("#"+zh_).remove()
        $('.jl').attr('disabled',false)
        if(num == 1){

        }else{
            zh_ = num--;
        }

    })
    //参照加点——建设日期
    layui.use('laydate', function(){
        var laydate = layui.laydate;
        //执行一个laydate实例
        laydate.render({
            elem: '#jsrq1'
            , type: 'date'
        });
    });
    //解析加点——建设日期
    layui.use('laydate', function(){
        var laydate = layui.laydate;
        //执行一个laydate实例
        laydate.render({
            elem: '#jsrq2'
            , type: 'date'
        });
    });
    //解析加线——建设日期
    layui.use('laydate', function(){
        var laydate = layui.laydate;
        //执行一个laydate实例
        laydate.render({
            elem: '#jsrq3'
            , type: 'date'
        });
    });
    //插入点——建设日期
    layui.use('laydate', function(){
        var laydate = layui.laydate;
        //执行一个laydate实例
        laydate.render({
            elem: '#jsrq4'
            , type: 'date'
        });
    });
    //连接点——建设日期
    layui.use('laydate', function(){
        var laydate = layui.laydate;
        //执行一个laydate实例
        laydate.render({
            elem: '#jsrq5'
            , type: 'date'
        });
    });
</script>
<script>
    $(() => {
        LoadMap.mapInit(null,{"pidType":"管线更新"});
        setBh("gspoint","GSP","gdbh1")
    })
    $('#search_content1') .bind('keypress', function (event) {
        if(event.keyCode == "13"){
           search($('#search_content1').val());
        }
    })
    $('#search_content4') .bind('keypress', function (event) {
        if(event.keyCode == "13"){
            search($('#search_content4').val());
        }
    })
    $('#search_btn1').click(function () {
        var seacheStr = $('#search_content1').val()
        search(seacheStr)
    })
    $('#search_btn4').click(function () {
        var seacheStr = $('#search_content4').val()
        search(seacheStr)
    })
    //百度地图道路查询
    function search(seacheStr) {
        $.ajax({
            //url中的参数含义参见百度地图官网webAPI文档
            url: 'http://api.map.baidu.com/place/v2/search?query='+seacheStr+'&region=北京市&page_size=40&page_num=0&output=json&ak=nSxiPohfziUaCuONe4ViUP2N',
            type: "GET",
            async: false,
            dataType: "jsonp",
            jsonp: "callback",
            jsonpCallback: "callback",
            contentType: "application/json;charset=utf-8",
            success: function (data) {
                console.log(data)
                if (data.status != 0) {
                    alert("搜索失败")
                } else if (data.results.length == 0) {
                    alert("暂无搜索结果")
                } else {
                    var lonlat = data.results[0].location.lng + "," + data.results[0].location.lat;
                    var array_LonLat = lonlat.split(",");
                    for (var i = 0; i < 2; i++) {
                        array_LonLat[i] = Number(array_LonLat[i]);
                    }
                    //搜索出来的经纬度定位到实际地图上有偏差，是因为我使用不是在线服务百度瓦片图，所以这里只能找出偏差度数先减一下
                    var new_lonlat = ol.proj.transform([array_LonLat[0]-0.012653,array_LonLat[1]-0.007422], 'EPSG:4326', 'BD:09')
                    var anchor = new ol.Feature({
                        geometry: new ol.geom.Point(new_lonlat)
                    });
                    /*
                                                                var searchLayer = new ol.layer.Vector({
                                                                    id: "search",
                                                                    source:  new ol.source.Vector({
                                                                        features: [anchor]
                                                                    }),
                                                                    style: olMapStyle.wsc_Style
                                                                });
                                                                LoadMap.map.addLayer(searchLayer)*/
                    LoadMap.map.getView().setCenter(new_lonlat);
                }
            },
            error: function (data) {
                console.log(data)
            }
        })
    }

    $('#czjd_type1').change(function() {
        var str;
        var options=$("#czjd_type1 option:selected");
        if(options.text() == "供水"){
            setBh("gspoint","GSP","gdbh1")
        }else if(options.text() == "雨水"){
            setBh("yspoint","YSP","gdbh1")
        }else if(options.text() == "污水"){
            setBh("wspoint","WSP","gdbh1")
        }else if(options.text() == "再生水"){
            setBh("zsspoint","ZSSP","gdbh1")
        }
    })

    function setBh(tableName,header,id) {
        $.ajax({
            url: "/hdsw/"+tableName+"/getMaxnum",
            type: "get",
            success: function (res) {
                var num = parseInt(res.data)+1
                var bh = header+num;
                $("#"+id+"").attr("value", bh);
            }
        })
    }

    $('#czjd_type2').change(function() {
        var str;
        var options=$("#czjd_type2 option:selected");
        if(options.text() == "供水"){
            setBh("gspoint","GSP","gdbh2")
        }else if(options.text() == "雨水"){
            setBh("yspoint","YSP","gdbh2")
        }else if(options.text() == "污水"){
            setBh("wspoint","WSP","gdbh2")
        }else if(options.text() == "再生水"){
            setBh("zsspoint","ZSSP","gdbh2")
        }
    })

    $('#czjd_type3').change(function() {
        var str;
        var options=$("#czjd_type3 option:selected");
        if(options.text() == "供水"){
            setBh("gsline","GSL","gxbh3")
        }else if(options.text() == "雨水"){
            setBh("ysline","YSL","gxbh3")
        }else if(options.text() == "污水"){
            setBh("wsline","WSL","gxbh3")
        }else if(options.text() == "再生水"){
            setBh("zssline","ZSSL","gxbh3")
        }
    })

    $('#czjd_type5').change(function() {
        var options=$("#czjd_type5 option:selected");
        if(options.text() == "供水"){
            setBh("gsline","GSL","gxbh5")
        }else if(options.text() == "雨水"){
            setBh("ysline","YSL","gxbh5")
        }else if(options.text() == "污水"){
            setBh("wsline","WSL","gxbh5")
        }else if(options.text() == "再生水"){
            setBh("zssline","ZSSL","gdbh5")
        }
        $("#lb5").attr("value", options.text());
    })

    //计算参考选点坐标
    function computeCoordinate() {
        if(num== 1){
            var lonLatObj = getLonAndLat($("#x1").val(),$("#y1").val(),$("#brng1").val(),$("#dis1").val())
            $("#xcor1").attr("value", lonLatObj.lon)
            $("#ycor1").attr("value", lonLatObj.lat)
/*            var new_lonlat = ol.proj.transform([lonLatObj.lon-0.012653,lonLatObj.lat-0.007422], 'EPSG:4326', 'BD:09')
            var anchor = new ol.Feature({
                geometry: new ol.geom.Point(new_lonlat)
            });
            var searchLayer = new ol.layer.Vector({
                id: "555",
                source:  new ol.source.Vector({
                    features: [anchor]
                }),
                style: olMapStyle.wsc_Style
            });
            LoadMap.map.addLayer(searchLayer)*/
        }else{
            //var tt = getIntersection(110.1112,36.61,Math.PI/4,110.1129,36.62,Math.PI/4*3)

            var lonLatObj = getIntersection($("#x1").val(),$("#y1").val(),$("#brng1").val(),$("#x2").val(),$("#y2").val(),$("#brng2").val())
            $("#xcor1").attr("value", lonLatObj.lon)
            $("#ycor1").attr("value", lonLatObj.lat)
/*            var new_lonlat = ol.proj.transform([lonLatObj.lon-0.012653,lonLatObj.lat-0.007422], 'EPSG:4326', 'BD:09')
            var anchor = new ol.Feature({
                geometry: new ol.geom.Point(new_lonlat)
            });
            var searchLayer = new ol.layer.Vector({
                id: "555",
                source:  new ol.source.Vector({
                    features: [anchor]
                }),
                style: olMapStyle.wsc_Style
            });
            LoadMap.map.addLayer(searchLayer)*/
        }
        LoadMap.getCoordinateFlag = undefined;
    }

    //获取坐标
    function getCoordinateFlag(clicked_id) {
        LoadMap.getCoordinateFlag = clicked_id;
    }

    var mapNumberUtil = {
        rad: function rad(d) {
            return d * Math.PI / 180.0;
        },
        deg: function deg(d) {
            return d * 180/ Math.PI
        }
    };
    /**
     * 根据一个经纬度及距离角度，算出另外一个经纬度
     * @param {*} lon 经度 113.3960698
     * @param {*} lat 纬度 22.941386
     * @param {*} brng 方位角 45 ---- 正北方：000°或360° 正东方：090° 正南方：180° 正西方：270°
     * @param {*} dist 90000距离(米)
     */
    function getLonAndLat (lon, lat, brng, dist) {
/*        lon = parseFloat(lon)-0.012653;
        lat = parseFloat(lat)-0.007422;*/
        //大地坐标系资料WGS-84 极坐标长半径a=6378137 极坐标短半径b=6356752.3142 扁率f=1/298.2572236
        var a = 6378137;
        var b = 6356752.3142;
        var f = 1 / 298.257223563;
        var lon1 = lon * 1;
        var lat1 = lat * 1;
        var s = dist;
        var alpha1 = mapNumberUtil.rad(brng);
        var sinAlpha1 = Math.sin(alpha1);
        var cosAlpha1 = Math.cos(alpha1);
        var tanU1 = (1 - f) * Math.tan(mapNumberUtil.rad(lat1));
        var cosU1 = 1 / Math.sqrt((1 + tanU1 * tanU1)),
            sinU1 = tanU1 * cosU1;
        var sigma1 = Math.atan2(tanU1, cosAlpha1);
        var sinAlpha = cosU1 * sinAlpha1;
        var cosSqAlpha = 1 - sinAlpha * sinAlpha;
        var uSq = cosSqAlpha * (a * a - b * b) / (b * b);
        var A = 1 + uSq / 16384 * (4096 + uSq * ( - 768 + uSq * (320 - 175 * uSq)));
        var B = uSq / 1024 * (256 + uSq * ( - 128 + uSq * (74 - 47 * uSq)));
        var sigma = s / (b * A),
            sigmaP = 2 * Math.PI;
        while (Math.abs(sigma - sigmaP) > 1e-12) {
            var cos2SigmaM = Math.cos(2 * sigma1 + sigma);
            var sinSigma = Math.sin(sigma);
            var cosSigma = Math.cos(sigma);
            var deltaSigma = B * sinSigma * (cos2SigmaM + B / 4 * (cosSigma * ( - 1 + 2 * cos2SigmaM * cos2SigmaM) - B / 6 * cos2SigmaM * ( - 3 + 4 * sinSigma * sinSigma) * ( - 3 + 4 * cos2SigmaM * cos2SigmaM)));
            sigmaP = sigma;
            sigma = s / (b * A) + deltaSigma;
        }
        var tmp = sinU1 * sinSigma - cosU1 * cosSigma * cosAlpha1;
        var lat2 = Math.atan2(sinU1 * cosSigma + cosU1 * sinSigma * cosAlpha1, (1 - f) * Math.sqrt(sinAlpha * sinAlpha + tmp * tmp));
        var lambda = Math.atan2(sinSigma * sinAlpha1, cosU1 * cosSigma - sinU1 * sinSigma * cosAlpha1);
        var C = f / 16 * cosSqAlpha * (4 + f * (4 - 3 * cosSqAlpha));
        var L = lambda - (1 - C) * f * sinAlpha * (sigma + C * sinSigma * (cos2SigmaM + C * cosSigma * ( - 1 + 2 * cos2SigmaM * cos2SigmaM)));
        var revAz = Math.atan2(sinAlpha, -tmp); // final bearing
        var lonLatObj = {
            lon: lon1 + mapNumberUtil.deg(L),
            lat: mapNumberUtil.deg(lat2)
        }

        return lonLatObj;
    }
    //根据两个点坐标以及与水平方向夹角求交点
    function getIntersection(lon1,lat1,angle1,lon2,lat2,angle2) {
        var lon, lat;
        var rad1 = mapNumberUtil.rad(angle1);
        var rad2 = mapNumberUtil.rad(angle2);
        if (angle1 == angle2 || angle1 + angle2 == 360) {
            return null;
        } else if (angle1 == 90 || angle1 == 270) {
            lon = lon1;
            lat = lat1 + Math.tan(rad2) * (lon1 - lon2)

        } else if (angle2 == 90 || angle2 == 270) {
            lon = lon2;
            lat = lat2 + Math.tan(rad1) * (lon2 - lon1)
        } else {
            lon = (lat2 - lat1 + lon1 * Math.tan(rad1) - lon2 * Math.tan(rad2)) / (Math.tan(rad1) - Math.tan(rad2));
            lat = (Math.tan(rad1) * Math.tan(rad2) * (lon2 - lon1) + Math.tan(rad2) * lat1 - Math.tan(rad1) * lat2) / (Math.tan(rad2) - Math.tan(rad1))
        }

        var lonLatObj = {
            lon: lon,
            lat: lat
        }
        return lonLatObj;
    }

        /*
    * 线段与线段的交点
    * 解线性方程组, 求线段AB与线段CD的交点坐标，如果没有交点，返回null
    */
    function intersects(coordinate1, coordinate2,coordinate3,coordinate4) {
        let x1 = coordinate1[0];
        let y1 = coordinate1[1];
        let x2 = coordinate2[0];
        let y2 = coordinate2[1];
        let x3 = coordinate3[0];
        let y3 = coordinate3[1];
        let x4 = coordinate4[0];
        let y4 = coordinate4[1];
        //斜率交叉相乘 k1 = (y4 - y3) / (x4 - x3)    k2 = (y2 - y1) / (x2 - x1)
        //k1 k2 同乘 (x4 - x3) * (x2 - x1) 并相减得到denom
        let denom = ((y4 - y3) * (x2 - x1)) - ((x4 - x3) * (y2 - y1));
        // 如果分母为0 则平行或共线, 不相交
        if (denom === 0) {
            return null;
        }

        let numeA = ((x4 - x3) * (y1 - y3)) - ((y4 - y3) * (x1 - x3));
        let numeB = ((x2 - x1) * (y1 - y3)) - ((y2 - y1) * (x1 - x3));
        let uA = numeA / denom;
        let uB = numeB / denom;

        // 交点在线段1上，且交点也在线段2上
        if (uA >= 0 && uA <= 1 && uB >= 0 && uB <= 1) {
            let x = x1 + (uA * (x2 - x1));
            let y = y1 + (uA * (y2 - y1));
            return [x,y];
        }
        return null;
    }

    //画线
    function drawLine() {
        LoadMap.map.removeInteraction(LoadMap.draw);
        LoadMap.map.removeLayer(LoadMap.drawLayer);
        ol.Observable.unByKey(LoadMap.mapClick);
        //创建draw图层加入地图
        LoadMap.drawLayer = new ol.layer.Vector({
            source: new ol.source.Vector(),
        });
        LoadMap.draw = new ol.interaction.Draw({
            source: LoadMap.drawLayer.getSource(),
            type: 'LineString'
        });
        LoadMap.map.addLayer(LoadMap.drawLayer);

        //创建draw控件加入地图
        LoadMap.map.addInteraction(LoadMap.draw);

        LoadMap.draw.on("drawend", (e) => {
            feature = [];
            let geom = e.feature.getGeometry();
            let sources = LoadMap.getLineSources();
            //let result = LoadMap.getSelectFeatures(sources, geom.getExtent());
            sources.forEach((source, i) => {
                source.forEachFeatureInExtent(geom.getExtent(), function (features) {
                    feature.push(features);
                });
            })
            LoadMap.map.removeInteraction(LoadMap.draw);
            LoadMap.map.removeLayer(LoadMap.drawLayer);
            LoadMap.singleclick();
            if(feature.length == 1){
                var coordinate1 =[geom.extent_[0],geom.extent_[1]];
                var coordinate2 =[geom.extent_[2],geom.extent_[3]];
                var coordinate3 =[feature[0].values_.geometry.extent_[0],feature[0].values_.geometry.extent_[1]];
                var coordinate4 =[feature[0].values_.geometry.extent_[2],feature[0].values_.geometry.extent_[3]];
                var point = intersects(coordinate1,coordinate2,coordinate3,coordinate4);
                var lonlat = ol.proj.transform([point[0],point[1]], 'BD:09', 'EPSG:4326')

                $("#gxbh4").attr("value", feature[0].values_.pipeid)
                $("#qdbh4").attr("value", feature[0].values_.s_point)
                $("#zdbh4").attr("value", feature[0].values_.e_point)
                $("#szdl4").attr("value", feature[0].values_.road)
                $("#qsdw4").attr("value", feature[0].values_.owner)
                $("#ywlb4").attr("value", feature[0].values_.type)

                var x = parseFloat(lonlat[0])-LoadMap.xOffset;
                var y = parseFloat(lonlat[1])-LoadMap.yOffset;
                $("#xcor4").attr("value", x)
                $("#ycor4").attr("value", y)



                if(feature[0].values_.type == "供水"){
                    url="/hdsw/gspoint/getMaxnum"
                    str = "GSP"
                }else if(feature[0].values_.type == "雨水"){
                    url="/hdsw/yspoint/getMaxnum"
                    str = "YSP"
                }else if(feature[0].values_.type == "污水"){
                    url="/hdsw/wspoint/getMaxnum"
                    str = "WSP"
                }else if(feature[0].values_.type == "再生水"){
                    url="/hdsw/zsspoint/getMaxnum"
                    str = "ZSSP"
                }
                $.ajax({
                    url: url,
                    type: "get",
                    success: function (res) {
                        var num = parseInt(res.data)+1
                        $("#gdbh4").attr("value", str+num);
                    }
                })
                LoadMap.map.render();
/*                var anchor = new ol.Feature({
                    geometry: new ol.geom.Point(point)
                });
                var searchLayer = new ol.layer.Vector({
                    id: "search",
                    source:  new ol.source.Vector({
                        features: [anchor]
                    }),
                    style: olMapStyle.wsc_Style
                });
                LoadMap.map.addLayer(searchLayer)*/
            }else{

            }
        });

    }
    //参考选点保存
    function save1() {
        var layer;
        var params = {
            expNo:$('#gdbh1').val(),
            feature:$('#tz1').val(),
            subsid:$('#fsw1').val(),
            elevation:$('#bg1').val(),
            sureH:$('#dmgc1').val(),
            botDepth:$('#jdms1').val(),
            covType:$('#jglx1').val(),
            covDn:$('#jggg1').val(),
            covMeat:$('#jgcz1').val(),
            wchaMeat:$('#jscz1').val(),
            wchaType:$('#jslx1').val(),
            foDeep:$('#jbs1').val(),
            wchaDn:$('#jszj1').val(),
            bTime:$('#jsrq1').val(),
            offcNo:$('#pxjdh1').val(),
            rotation:$('#xzjd1').val(),
            x:$('#xcor1').val(),
            y:$('#ycor1').val(),
            owner:$('#qsdw1').val(),
            road:$('#ssdl1').val(),
            geom:"POINTZM("+$('#xcor1').val()+" " +$('#ycor1').val()+ " 0  -1.79769e+308)",
            delState:'0',
            updState:'0'
        };
        var url;
        var options=$("#czjd_type1 option:selected");
        if(options.text() == "供水"){
            layer = LoadMap.map.getLayerById("gsjg");
            url="/hdsw/gspoint/insert"
        }else if(options.text() == "雨水"){
            layer = LoadMap.map.getLayerById("ysjg");
            url="/hdsw/yspoint/insert"
        }else if(options.text() == "污水"){
            layer = LoadMap.map.getLayerById("wsjg");
            url="/hdsw/wspoint/insert"
        }else if(options.text() == "再生水"){
            layer = LoadMap.map.getLayerById("zssjg");
            url="/hdsw/zsspoint/insert"
        }
        $.ajax({
            url: url,
            type: "post",
            contentType: 'application/json',
            dataType: 'json',
            data: JSON.stringify(params),
            success: function (data) {
                if(data.code==0){
                    layui.use('layer', () => {
                        let layer = layui.layer;
                        layer.msg("添加成功")
                    })
                }else{
                    layui.use('layer', () => {
                        let layer = layui.layer;
                        layer.msg("添加失败")
                    })
                }
                LoadMap.getCoordinateFlag=undefined;
                layer.getSource().changed();
            }
        })
    }
    //解析加点点保存
    function save2() {
        var params = {
            expNo:$('#gdbh2').val(),
            feature:$('#tz2').val(),
            subsid:$('#fsw2').val(),
            elevation:$('#bg2').val(),
            sureH:$('#dmgc2').val(),
            botDepth:$('#jdms2').val(),
            covType:$('#jglx2').val(),
            covDn:$('#jggg2').val(),
            covMeat:$('#jgcz2').val(),
            wchaMeat:$('#jscz2').val(),
            wchaType:$('#jslx2').val(),
            foDeep:$('#jbs2').val(),
            wchaDn:$('#jszj2').val(),
            bTime:$('#jsrq2').val(),
            offcNo:$('#pxjdh2').val(),
            rotation:$('#xzjd2').val(),
            x:$('#xcor2').val(),
            y:$('#ycor2').val(),
            owner:$('#qsdw2').val(),
            road:$('#ssdl2').val(),
            geom:"POINTZM("+$('#xcor2').val()+" " +$('#ycor2').val()+ " 0 0)",
            delState:'0',
            updState:'0'
        };
        var url;
        var options=$("#czjd_type2 option:selected");
        if(options.text() == "供水"){
            url="/hdsw/gspoint/insert"
        }else if(options.text() == "雨水"){
            url="/hdsw/yspoint/insert"
        }else if(options.text() == "污水"){
            url="/hdsw/wspoint/insert"
        }else if(options.text() == "再生水"){
            url="/hdsw/zsspoint/insert"
        }
        $.ajax({
            url: url,
            type: "post",
            contentType: 'application/json',
            dataType: 'json',
            data: JSON.stringify(params),
            success: function (data) {
                if(data.code==0){
                    layui.use('layer', () => {
                        let layer = layui.layer;
                        layer.msg("添加成功")
                    })
                }else{
                    layui.use('layer', () => {
                        let layer = layui.layer;
                        layer.msg("添加失败")
                    })
                }
                LoadMap.getCoordinateFlag=undefined;
                LoadMap.map.render();
            }
        })
    }
    //解析加线保存
    function save3() {
        var params = {
            shapeLeng:$('#cd3').val(),
            pipeid:$('#gxbh3').val(),
            sPoint:$('#qdbh3').val(),
            ePoint:$('#zdbh3').val(),
            sDeep:$('#qdmss3').val(),
            eDeep:$('#zdms3').val(),
            material:$('#cz3').val(),
            dType:$('#msfs3').val(),
            dS:$('#gj3').val(),
            flowdirect:$('#lx3').val(),
            sHeight:$('#qdgc3').val(),
            eHeight:$('#zdgc3').val(),
            bTime:$('#jsrq3').val(),
            state:$('#zt3').val(),
            type:$('#lb3').val(),
            road:$('#szdl3').val(),
            owner:$('#qsdwbh3').val(),
            geom:"MULTILINESTRING ZM(("+$('#qdxcor3').val()+" " +$('#qdycor3').val()+ " 0 0,"+$('#zdxcor3').val()+" " +$('#zdycor3').val()+ " 0 0"+"))",
            delState:'0',
            updState:'0'
        };
        var url;
        var options=$("#czjd_type3 option:selected");
        if(options.text() == "供水"){
            url="/hdsw/gsline/insert"
        }else if(options.text() == "雨水"){
            url="/hdsw/ysline/insert"
        }else if(options.text() == "污水"){
            url="/hdsw/wsline/insert"
        }else if(options.text() == "再生水"){
            url="/hdsw/zssline/insert"
        }
        $.ajax({
            url: url,
            type: "post",
            contentType: 'application/json',
            dataType: 'json',
            data: JSON.stringify(params),
            success: function (data) {
                if(data.code==0){
                    layui.use('layer', () => {
                        let layer = layui.layer;
                        layer.msg("添加成功")
                    })
                }else{
                    layui.use('layer', () => {
                        let layer = layui.layer;
                        layer.msg("添加失败")
                    })
                }
                LoadMap.getCoordinateFlag=undefined;
                LoadMap.map.render();
            }
        })
    }
    //插入点保存
    function save4() {
       // var new_lonlat = ol.proj.transform([$('#xcor4').val(),$('#ycor4').val()], 'EPSG:4326', 'BD:09')
        var x = parseFloat($('#xcor4').val()) +0.012653;
        var y = parseFloat($('#ycor4').val()) +0.012653;
        var params = {
            expNo:$('#gdbh4').val(),
            feature:$('#tz4').val(),
            subsid:$('#fsw4').val(),
            elevation:$('#bg4').val(),
            sureH:$('#dmgc4').val(),
            botDepth:$('#jdms4').val(),
            covType:$('#jglx4').val(),
            covDn:$('#jggg4').val(),
            covMeat:$('#jgcz4').val(),
            wchaMeat:$('#jscz4').val(),
            wchaType:$('#jslx4').val(),
            foDeep:$('#jbs4').val(),
            wchaDn:$('#jszj4').val(),
            bTime:$('#jsrq4').val(),
            offcNo:$('#pxjdh4').val(),
            rotation:$('#xzjd4').val(),
            x:$('#xcor4').val(),
            y:$('#ycor4').val(),
            owner:$('#qsdw4').val(),
            road:$('#ssdl4').val(),
            geom:"POINTZM("+$('#xcor4').val()+" " +$('#ycor4').val()+ " 0 -1.79769e+308)",
            delState:'0',
            updState:'0'
        };
        var url;
        var url1;
        var options=$('#ywlb4').val();
        if(options == "供水"){
            url="/hdsw/gspoint/insert"
            url1="/hdsw/gsline/update"
        }else if(options == "雨水"){
            url="/hdsw/yspoint/insert"
            url1="/hdsw/ysline/interruptLine"
        }else if(options == "污水"){
            url="/hdsw/wspoint/insert"
            url1="/hdsw/wsline/update"
        }else if(options == "再生水"){
            url="/hdsw/zsspoint/insert"
            url1="/hdsw/zssline/update"
        }
        $.ajax({
            url: url,
            type: "post",
            contentType: 'application/json',
            dataType: 'json',
            data: JSON.stringify(params),
            success: function (res) {
                if(res.code==0){
                    Debugger:
                    $.ajax({
                        url: url1,
                        type: "post",
                        dataType: 'json',
                        data: {
                            gxbh:$('#gxbh4').val().toString(),
                            gdbh:$('#gdbh4').val().toString()
                        },
                        success: function (res) {
                            if(res.code==0){
                                layui.use('layer', () => {
                                    let layer = layui.layer;
                                    layer.msg("添加成功")
                                })
                            }else{
                                layui.use('layer', () => {
                                    let layer = layui.layer;
                                    layer.msg("添加失败")
                                })
                            }
                        }
                    })
                    LoadMap.map.render();
                }
            }
        })
    }
    //连接点保存
    function save5() {
        var params = {
            shapeLeng:$('#cd5').val(),
            pipeid:$('#gxbh5').val(),
            sPoint:$('#qdbh5').val(),
            ePoint:$('#zdbh5').val(),
            sDeep:$('#qdms5').val(),
            eDeep:$('#zdms5').val(),
            material:$('#cz5').val(),
            dType:$('#msfs5').val(),
            dS:$('#gj5').val(),
            flowdirect:$('#lx5').val(),
            sHeight:$('#qdgc5').val(),
            eHeight:$('#zdgc5').val(),
            bTime:$('#jsrq5').val(),
            state:$('#zt5').val(),
            type:$('#lb5').val(),
            road:$('#szdl5').val(),
            owner:$('#qsdwbh5').val(),
            geom:"MULTILINESTRING ZM(("+$('#qdxcor5').val()+" " +$('#qdycor5').val()+ " 0 0,"+$('#zdxcor5').val()+" " +$('#zdycor5').val()+ " 0 0"+"))",
            delState:'0',
            updState:'0'
        };
        var url;
        var options=$("#czjd_type5 option:selected");
        if(options.text() == "供水"){
            url="/hdsw/gsline/insert"
        }else if(options.text() == "雨水"){
            url="/hdsw/ysline/insert"
        }else if(options.text() == "污水"){
            url="/hdsw/wsline/insert"
        }else if(options.text() == "再生水"){
            url="/hdsw/zssline/insert"
        }
        $.ajax({
            url: url,
            type: "post",
            contentType: 'application/json',
            dataType: 'json',
            data: JSON.stringify(params),
            success: function (data) {
                if(data.code==0){
                    layui.use('layer', () => {
                        let layer = layui.layer;
                        layer.msg("添加成功")
                    })
                }else{
                    layui.use('layer', () => {
                        let layer = layui.layer;
                        layer.msg("添加失败")
                    })
                }
                LoadMap.getCoordinateFlag=undefined;
                LoadMap.map.render();
            }
        })
    }
</script>
